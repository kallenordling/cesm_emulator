{
  "data": {
    "cond_file": "./CESM2-LESN_emulator/co2_final.nc",
    "target_file": "./CESM2-LESN_emulator/splits/fold_1/climate_data_train_fold1.nc",
    "run_dir": "runs/exp_baseline",
    "cond_var": "CO2_em_anthro",
    "target_var": "TREFHT",
    "member_dim": "member_id",
    "stack_dim": "year",
    "lat_name": "lat",
    "lon_name": "lon",
    "normalize_cond": true
  },
  "dataset": {
    "K": 3,
    "center": true,
    "crop_hw": [128, 128],
    "crop_mode": "random",
    "time_reverse_p": 0.5,
    "sample_mode": "consecutive",
    "window_radius": 5,
    "keep_chronology": true,
    "causal": false
  },
  "unet": {
    "in_channels": 2,
    "out_channels": 1,
    "base_ch": 64,
    "ch_mults": [1, 2, 4, 8],
    "num_res_blocks": 6,
    "time_dim": 124,
    "groups": 8,
    "dropout": 0.0,
    "use_checkpoint": true
  },
  "train": {
    "backend": "fsdp",
    "batch_size": 64,
    "accum_steps": 4,
    "num_workers": 1,
    "num_epochs": 10000,
    "save_every": 10,
    "sample_every": 100,
    "save_dir": "runs/exp_test2",
    "use_amp": true,
    "max_grad_norm": 1.0,
    "sample_batch": 1,
    "seed": 42,

    /* IMPORTANT: your script reads these from `train` */
    "timesteps": 1000,
    "beta_schedule": "linear",

    "optimizer": {
      "lr": 0.0002,
      "betas": [0.9, 0.999],
      "weight_decay": 0.0001
    },

    "fsdp": {
      "enabled": true,
      "sharding": "full",
      "wrap_min_params": 1000000,
      "cpu_offload": false,
      "mixed_precision": "bf16"
    },

    "deepspeed": {
      "enabled": false,
      "zero_stage": 3,
      "bf16": true,
      "offload_params_to_cpu": true,
      "offload_optimizer_to_cpu": true,
      "nvme_offload": false,
      "optimizer": {
        "type": "AdamW",
        "params": { "lr": 0.0002, "betas": [0.9, 0.999], "eps": 1e-8, "weight_decay": 0.0001 }
      },
      "gradient_accumulation_steps": 1
    }
  },

  /* Top-level mirrors (your loader merges top-level + train.* in the patched script) */
  "fsdp": {
    "enabled": true,
    "sharding": "full",
    "wrap_min_params": 1000000,
    "cpu_offload": false,
    "mixed_precision": "bf16"
  },
  "deepspeed": {
    "enabled": false,
    "zero_stage": 3,
    "bf16": true,
    "offload_params_to_cpu": true,
    "offload_optimizer_to_cpu": true,
    "nvme_offload": false,
    "optimizer": {
      "type": "AdamW",
      "params": { "lr": 0.0002, "betas": [0.9, 0.999], "eps": 1e-8, "weight_decay": 0.0001 }
    },
    "gradient_accumulation_steps": 1
  }
}
